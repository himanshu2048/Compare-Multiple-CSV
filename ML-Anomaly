import pandas as pd
from sklearn.ensemble import IsolationForest

# Assuming your CSV file is named 'your_file.csv'
csv_file_path = 'your_file.csv'

# Load CSV into DataFrame
df = pd.read_csv(csv_file_path)

# Create a DataFrame with only the 'count' column (features)
X = df[['count']]

# Initialize and fit the Isolation Forest model
model = IsolationForest(contamination=0.05)  # You can adjust the contamination parameter based on your data
model.fit(X)

# Predict outliers (anomalies)
df['anomaly'] = model.predict(X)

# Filter rows with anomalies
anomalies = df[df['anomaly'] == -1]

# Drop the 'anomaly' column if you don't need it anymore
anomalies = anomalies.drop(columns=['anomaly'])

# Display the anomalies
print(anomalies)
