import pandas as pd
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import IsolationForest
import matplotlib.pyplot as plt

# Load your data
df = pd.read_csv('your_file.csv')

# Select the feature for anomaly detection
X = df[['count']]

# Initialize and fit StandardScaler
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Initialize and fit Isolation Forest
model = IsolationForest(contamination=0.05)
model.fit(X_scaled)

# Predict outliers (anomalies)
df['anomaly'] = model.predict(X_scaled)

# Visualize the anomalies
plt.figure(figsize=(12, 6))
plt.scatter(df.index, df['count'], c=df['anomaly'], cmap='viridis', marker='o')
plt.title('Anomaly Detection with Isolation Forest')
plt.xlabel('Index')
plt.ylabel('Count')
plt.colorbar(label='Anomaly (1: Normal, -1: Anomaly)')
plt.show()
